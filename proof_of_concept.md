
**Vulnerability Name:** SQL Injection on GeoSiap ERP (2.2.167.02 ) login form

**Date of Discovery:** 17 November 2023

**Product version:** 2.2.167.02 

**Author:** vgdpx

**Vulnerability Description:** Any public user/guest (unauthenticated) can inject malicious SQL query in order to affect the execution of predefined SQL commands via the "codLogin" parameter on the login form. Upon successful of SQL injection attack, attacker can read sensitive data from the database or modify database data. 
GeoSiap is an ERP system for government applications, used by approximately 25 cities, meaning that this is an extremely critical vulnerability, which could result in the leakage of millions of people's data.

**Vulnerable URL:** _http://localhost/websis/siapegov/recursos_humanos/grh/grh_rh_online.php

**Proof of Concept:**

**1)** In an application running ERP GeoSiap version 2.2.167.02, we can test the codLogin parameter with a simple time-based injection "codLogin=test') AND 4848=(SELECT 4848 FROM PG_SLEEP(5)) we can assume that the database used is PostgresSQL.

**Fetching database info**

![Fetching](https://github.com/VauP/CVE-IDs/blob/main/Databases.png?raw=true)

**2)** With this information, we can automate the process with the help of SQLMap, and easily gain full access to the database.

**Dump database name = public**

![Dump](https://github.com/VauP/CVE-IDs/blob/83dfc0ec5ecb79ee960b87c41a1d7089b6d2d4a7/Dump.png?raw=true)

**3)** Once we know this, a basic google dorks (intitle: "Servicos On-line 2.2.167.02" login) is able to return all the cities that use the same vulnerable version, and we get the result that approximately 25 cities use this system.

**Dorks results**

![Dorks](https://github.com/VauP/CVE-IDs/blob/main/Dorks.png?raw=true)

**Consequences:** 

- Confidentiality: Since SQL databases generally hold sensitive data, loss of confidentiality is a frequent problem with SQL Injection vulnerabilities.
- Integrity: Just as it may be possible to read sensitive information eg client/customer sensitive data, it is also possible to make changes or even delete this information with a SQL Injection attack.

**Mitigation:** Use of Prepared Statements (with Parameterized Queries). It would also be good to sanitize the input parameters to eliminate unwanted characters.

**References for Mitigation Vulnerability:** https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html

**References:** 
- https://github.com/VauP/CVE-IDs
- https://owasp.org/www-community/attacks/SQL_Injection
